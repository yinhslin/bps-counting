(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66092,       1828]
NotebookOptionsPosition[     61639,       1746]
NotebookOutlinePosition[     62078,       1763]
CellTagsIndexPosition[     62035,       1760]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.871889858032716*^9, 3.871889859541623*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"e9a463c4-f573-4bdc-bfd1-ac366b2ed6e4"],

Cell[CellGroupData[{

Cell["Load data", "Section",
 CellChangeTimes->{{3.8718894977127943`*^9, 
  3.871889499476142*^9}},ExpressionUUID->"72eb439b-d53a-46d1-a943-\
cdc50184b3e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Load", " ", "data", " ", "first"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"cohomology", "[", "NN", "]"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          "\"\<cohomology_\>\"", "<>", 
          RowBox[{"ToString", "[", "NN", "]"}], "<>", "\"\<.csv\>\""}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"NN", ",", "2", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxLevel", "[", "NN_", "]"}], " ", ":=", " ", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "NN", ",", "\[IndentingNewLine]", "2", ",", "25", ",", 
       "\[IndentingNewLine]", "3", ",", "19", ",", "\[IndentingNewLine]", "4",
        ",", "15"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumAllStatesUpToLevel", "[", 
      RowBox[{"NN_", ",", "level_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "9", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"cohomology", "[", "NN", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<=", "level"}], "&"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumAllStates", "[", 
      RowBox[{"NN_", ",", "charges_", ",", "degree_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"cohomology", "[", "NN", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", "6"}], "]"}], "]"}], "==", "charges"}], "&&", 
          
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "==", "degree"}]}], "&"}]}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "9"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"NumMultiGravitonStates", "[", 
      RowBox[{"NN_", ",", "charges_", ",", "degree_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"cohomology", "[", "NN", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", "6"}], "]"}], "]"}], "==", "charges"}], "&&", 
          
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "==", "degree"}]}], "&"}]}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "10"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.871843981562728*^9, 3.871844021412464*^9}, {
  3.871844300547426*^9, 3.871844305441814*^9}, {3.8718466090518503`*^9, 
  3.871846631175758*^9}, {3.871889524731697*^9, 3.871889524937023*^9}, {
  3.871934637857525*^9, 3.871934637997019*^9}, {3.891614347704235*^9, 
  3.8916143659776773`*^9}, {3.891614447308642*^9, 3.891614463105507*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c60f7b66-59f5-4fe8-afbb-c7f138d1fc76"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Usage", " ", "example"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NumAllStates", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "4", ",", "4", ",", "4"}], "}"}], ",", 
     "7"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"NumMultiGravitonStates", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "4", ",", "4", ",", "4"}], "}"}], ",", 
     "7"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.871844203375235*^9, 3.871844218460442*^9}, {
  3.871844277517478*^9, 3.8718442975740833`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"df88e7a5-f3e0-4241-9426-f502367c19e7"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8718442123203907`*^9, 3.871844278015366*^9}, 
   3.871844310901622*^9, 3.871889873117633*^9, {3.87193463715954*^9, 
   3.8719346401507597`*^9}, 3.871982492859174*^9, 3.8719835707935*^9, 
   3.891614328639839*^9, 3.891614397650855*^9, 3.891615647872913*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"d4906fc6-0627-486f-a24c-18ef15c95d64"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8718442123203907`*^9, 3.871844278015366*^9}, 
   3.871844310901622*^9, 3.871889873117633*^9, {3.87193463715954*^9, 
   3.8719346401507597`*^9}, 3.871982492859174*^9, 3.8719835707935*^9, 
   3.891614328639839*^9, 3.891614397650855*^9, 3.8916156478783693`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"2eafb431-0b7e-41c8-96f4-2f1a7973114f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["U(1) partition function", "Section",
 CellChangeTimes->{{3.871846316212592*^9, 
  3.87184633212936*^9}},ExpressionUUID->"5df60134-ca17-4e58-bfdb-\
45e61afd765e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"level", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZU1sw", "[", 
   RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"a", "+", "b", "-", 
     RowBox[{"a", " ", "b"}], "+", "u", "+", "v", "+", "w", "+", 
     RowBox[{"u", " ", "v"}], "+", 
     RowBox[{"u", " ", "w"}], "+", 
     RowBox[{"v", " ", "w"}], "+", 
     RowBox[{"u", " ", "v", " ", "w"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "a"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "b"}], ")"}]}]], " ", 
   "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZU1B", "[", 
   RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ZU1sw", "[", 
      RowBox[{"x", ",", "a", ",", "b", ",", "u", ",", "v", ",", "w"}], "]"}], 
     "+", 
     RowBox[{"ZU1sw", "[", 
      RowBox[{
       RowBox[{"-", "x"}], ",", "a", ",", "b", ",", 
       RowBox[{"-", "u"}], ",", 
       RowBox[{"-", "v"}], ",", 
       RowBox[{"-", "w"}]}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZU1F", "[", 
    RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ZU1sw", "[", 
       RowBox[{"x", ",", "a", ",", "b", ",", "u", ",", "v", ",", "w"}], "]"}],
       "-", 
      RowBox[{"ZU1sw", "[", 
       RowBox[{
        RowBox[{"-", "x"}], ",", "a", ",", "b", ",", 
        RowBox[{"-", "u"}], ",", 
        RowBox[{"-", "v"}], ",", 
        RowBox[{"-", "w"}]}], "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZU1", "[", 
   RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
   "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "n"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ZU1B", "[", 
               RowBox[{
                SuperscriptBox["x", "n"], ",", 
                RowBox[{
                 SuperscriptBox["a", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"3", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["b", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"3", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["u", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"2", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["v", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"2", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["w", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"2", "n"}]]}]}], "]"}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "n"], 
               RowBox[{"ZU1F", "[", 
                RowBox[{
                 SuperscriptBox["x", "n"], ",", 
                 RowBox[{
                  SuperscriptBox["a", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"3", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["b", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"3", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["u", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"2", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["v", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"2", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["w", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"2", "n"}]]}]}], "]"}]}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"level", "/", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "level"}], "}"}]}], "]"}], "//", 
      "Normal"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", "1"}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZU1reduced", "[", "x_", "]"}], ":=", 
  RowBox[{"ZU1", "[", 
   RowBox[{"1", ",", 
    SuperscriptBox["x", "3"], ",", 
    SuperscriptBox["x", "3"], ",", 
    SuperscriptBox["x", "2"], ",", 
    SuperscriptBox["x", "2"], ",", 
    SuperscriptBox["x", "2"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IU1reduced", "[", "x_", "]"}], ":=", 
  RowBox[{"ZU1", "[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    SuperscriptBox["x", "3"], ",", 
    SuperscriptBox["x", "3"], ",", 
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}], ",", 
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}], ",", 
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.87012686498415*^9, 3.870126945979604*^9}, {
  3.87012701053227*^9, 3.870127063987011*^9}, {3.870127765112111*^9, 
  3.870127765381899*^9}, {3.871846305206588*^9, 3.871846307284298*^9}, {
  3.871846385818619*^9, 3.871846421465653*^9}, {3.871846592176824*^9, 
  3.8718466166178226`*^9}, {3.871846659419326*^9, 3.871846743535535*^9}, {
  3.871846776520521*^9, 3.8718467771836843`*^9}, {3.87184685619092*^9, 
  3.871846998117567*^9}, {3.871889557311818*^9, 3.8718896087382517`*^9}, {
  3.871889718914165*^9, 3.871889751390667*^9}, {3.871889831809308*^9, 
  3.8718898514884777`*^9}, {3.871890010071574*^9, 3.871890010212618*^9}, {
  3.8718903300496063`*^9, 3.8718903342604322`*^9}, {3.871934647709834*^9, 
  3.8719346618178797`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"79b5541d-713d-480b-8eb7-cb735d66133c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Partition function", "Section",
 CellChangeTimes->{{3.871846316212592*^9, 3.87184633212936*^9}, 
   3.871889664786765*^9},ExpressionUUID->"3d356396-679f-4559-9c65-\
33ecefba003b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChargeList", "[", "level_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"Sort", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nzn", ",", "nzp"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n\[Theta]1", ",", "n\[Theta]2", ",", "n\[Theta]3"}], 
           "}"}]}], "}"}], "/.", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"3", " ", "nzn"}], "+", 
            RowBox[{"3", " ", "nzp"}], "+", 
            RowBox[{"2", " ", "n\[Theta]1"}], "+", 
            RowBox[{"2", " ", "n\[Theta]2"}], "+", 
            RowBox[{"2", " ", "n\[Theta]3"}]}], "==", "level"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "nzn", ",", "nzp", ",", "n\[Theta]1", ",", "n\[Theta]2", ",", 
            "n\[Theta]3"}], "}"}], ",", "NonNegativeIntegers"}], "]"}]}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermutationMultiplicity", "[", "charges_", "]"}], " ", ":=", " ", 
   
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Permutations", "[", 
      RowBox[{"charges", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "]"}], "*", 
    RowBox[{"Length", "[", 
     RowBox[{"Permutations", "[", 
      RowBox[{"charges", "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", "5"}], "]"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Index", "[", 
    RowBox[{"NN_", ",", "charges_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"degree", "+", 
          RowBox[{"Plus", "@@", 
           RowBox[{"charges", "[", 
            RowBox[{"[", 
             RowBox[{"3", ";;", "5"}], "]"}], "]"}]}]}], ")"}]}], " ", 
       RowBox[{"PermutationMultiplicity", "[", "charges", "]"}], 
       RowBox[{"NumAllStates", "[", 
        RowBox[{"NN", ",", "charges", ",", "degree"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"degree", ",", "2", ",", 
        RowBox[{"Total", "[", "charges", "]"}]}], "}"}]}], "]"}], "/;", 
    RowBox[{"ListQ", "[", "charges", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumAllStates", "[", 
    RowBox[{"NN_", ",", "charges_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"PermutationMultiplicity", "[", "charges", "]"}], 
       RowBox[{"NumAllStates", "[", 
        RowBox[{"NN", ",", "charges", ",", "degree"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"degree", ",", "2", ",", 
        RowBox[{"Total", "[", "charges", "]"}]}], "}"}]}], "]"}], "/;", 
    RowBox[{"ListQ", "[", "charges", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Index", "[", 
    RowBox[{"NN_", ",", "level_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Index", "[", 
       RowBox[{"NN", ",", "charges"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"charges", ",", 
        RowBox[{"ChargeList", "[", "level", "]"}]}], "}"}]}], "]"}], "/;", 
    RowBox[{"IntegerQ", "[", "level", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumAllStates", "[", 
    RowBox[{"NN_", ",", "level_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"NumAllStates", "[", 
       RowBox[{"NN", ",", "charges"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"charges", ",", 
        RowBox[{"ChargeList", "[", "level", "]"}]}], "}"}]}], "]"}], "/;", 
    RowBox[{"IntegerQ", "[", "level", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Index", "[", "NN_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Index", "[", "NN", "]"}], " ", "=", " ", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Index", "[", 
            RowBox[{"NN", ",", "level"}], "]"}], 
           RowBox[{"x", "^", "level"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"level", ",", "4", ",", 
            RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}], ")"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumAllStates", "[", "NN_", "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"NumAllStates", "[", "NN", "]"}], " ", "=", " ", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumAllStates", "[", 
            RowBox[{"NN", ",", "level"}], "]"}], 
           RowBox[{"x", "^", "level"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"level", ",", "4", ",", 
            RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}], ")"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UIndex", "[", "NN_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"UIndex", "[", "NN", "]"}], " ", "=", " ", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IU1reduced", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Index", "[", 
             RowBox[{"NN", ",", "level"}], "]"}], 
            RowBox[{"x", "^", "level"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"level", ",", "4", ",", 
             RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UNumAllStates", "[", "NN_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"UNumAllStates", "[", "NN", "]"}], " ", "=", " ", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ZU1reduced", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NumAllStates", "[", 
             RowBox[{"NN", ",", "level"}], "]"}], 
            RowBox[{"x", "^", "level"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"level", ",", "4", ",", 
             RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"MaxLevel", "[", "NN", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.871846325106148*^9, 3.871846599244337*^9}, {
  3.8718466362178173`*^9, 3.871846679841818*^9}, {3.871846782561214*^9, 
  3.871846809066427*^9}, {3.871846863843618*^9, 3.871846927361081*^9}, {
  3.871889685347383*^9, 3.8718896936605577`*^9}, {3.87188976160763*^9, 
  3.8718897767849483`*^9}, {3.871889879758588*^9, 3.8718898801128263`*^9}, {
  3.8718900525762777`*^9, 3.871890078705873*^9}, {3.871890224464738*^9, 
  3.871890246024521*^9}, {3.8718904235818443`*^9, 3.871890440122961*^9}, {
  3.8719347646760263`*^9, 3.871934784237718*^9}, {3.871934902402828*^9, 
  3.8719349378187943`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"87dc0c9b-6b9c-46ef-8667-114efd102d86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UIndex", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.8719835722708063`*^9, 3.87198357684096*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"2474c19d-5360-473b-8d07-be672424346e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["x", "2"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["x", "3"]}], "+", 
   RowBox[{"9", " ", 
    SuperscriptBox["x", "4"]}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "5"]}], "+", 
   RowBox[{"11", " ", 
    SuperscriptBox["x", "6"]}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "7"]}], "+", 
   RowBox[{"9", " ", 
    SuperscriptBox["x", "8"]}], "+", 
   RowBox[{"14", " ", 
    SuperscriptBox["x", "9"]}], "-", 
   RowBox[{"21", " ", 
    SuperscriptBox["x", "10"]}], "+", 
   RowBox[{"36", " ", 
    SuperscriptBox["x", "11"]}], "-", 
   RowBox[{"17", " ", 
    SuperscriptBox["x", "12"]}], "-", 
   RowBox[{"18", " ", 
    SuperscriptBox["x", "13"]}], "+", 
   RowBox[{"114", " ", 
    SuperscriptBox["x", "14"]}], "-", 
   RowBox[{"194", " ", 
    SuperscriptBox["x", "15"]}], "+", 
   RowBox[{"258", " ", 
    SuperscriptBox["x", "16"]}], "-", 
   RowBox[{"168", " ", 
    SuperscriptBox["x", "17"]}], "-", 
   RowBox[{"112", " ", 
    SuperscriptBox["x", "18"]}], "+", 
   RowBox[{"630", " ", 
    SuperscriptBox["x", "19"]}], "-", 
   RowBox[{"1089", " ", 
    SuperscriptBox["x", "20"]}], "+", 
   RowBox[{"1130", " ", 
    SuperscriptBox["x", "21"]}], "-", 
   RowBox[{"273", " ", 
    SuperscriptBox["x", "22"]}], "-", 
   RowBox[{"1632", " ", 
    SuperscriptBox["x", "23"]}], "+", 
   RowBox[{"4104", " ", 
    SuperscriptBox["x", "24"]}], "-", 
   RowBox[{"5364", " ", 
    SuperscriptBox["x", "25"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "26"],
    SeriesData[$CellContext`x, 0, {}, 0, 26, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {1, 0, 3, -2, 9, -6, 11, -6, 9, 14, -21, 
   36, -17, -18, 114, -194, 258, -168, -112, 630, -1089, 1130, -273, -1632, 
   4104, -5364}, 0, 26, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.8719836012443857`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"ff05b652-1628-497a-8c2e-b03b79a69146"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Index", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.871983689018382*^9, 3.871983691374935*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"18cc7b10-b922-4efc-ad97-d64db2405699"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "4"]}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "5"]}], "-", 
   RowBox[{"7", " ", 
    SuperscriptBox["x", "6"]}], "+", 
   RowBox[{"18", " ", 
    SuperscriptBox["x", "7"]}], "+", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "8"]}], "-", 
   RowBox[{"36", " ", 
    SuperscriptBox["x", "9"]}], "+", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "10"]}], "+", 
   RowBox[{"84", " ", 
    SuperscriptBox["x", "11"]}], "-", 
   RowBox[{"80", " ", 
    SuperscriptBox["x", "12"]}], "-", 
   RowBox[{"132", " ", 
    SuperscriptBox["x", "13"]}], "+", 
   RowBox[{"309", " ", 
    SuperscriptBox["x", "14"]}], "-", 
   RowBox[{"18", " ", 
    SuperscriptBox["x", "15"]}], "-", 
   RowBox[{"567", " ", 
    SuperscriptBox["x", "16"]}], "+", 
   RowBox[{"516", " ", 
    SuperscriptBox["x", "17"]}], "+", 
   RowBox[{"613", " ", 
    SuperscriptBox["x", "18"]}], "-", 
   RowBox[{"1392", " ", 
    SuperscriptBox["x", "19"]}], "-", 
   RowBox[{"180", " ", 
    SuperscriptBox["x", "20"]}], "+", 
   RowBox[{"2884", " ", 
    SuperscriptBox["x", "21"]}], "-", 
   RowBox[{"1926", " ", 
    SuperscriptBox["x", "22"]}], "-", 
   RowBox[{"4242", " ", 
    SuperscriptBox["x", "23"]}], "+", 
   RowBox[{"7890", " ", 
    SuperscriptBox["x", "24"]}], "+", 
   RowBox[{"792", " ", 
    SuperscriptBox["x", "25"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "26"],
    SeriesData[$CellContext`x, 0, {}, 0, 26, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {1, 0, 0, 0, 6, -6, -7, 18, 6, -36, 6, 
   84, -80, -132, 309, -18, -567, 516, 613, -1392, -180, 2884, -1926, -4242, 
   7890, 792}, 0, 26, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.871983689952854*^9, 3.871983715913987*^9}},
 CellLabel->"Out[60]=",ExpressionUUID->"14f1115d-1582-448b-9d05-75f5faf26155"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graviton partition function", "Section",
 CellChangeTimes->{{3.8719830740208073`*^9, 
  3.871983078312253*^9}},ExpressionUUID->"b38d8bef-d1aa-49fc-9525-\
03332681ba32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"level", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", " ", "u"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", " ", "v"}], ")"}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "  ", "w"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "a"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", " ", "b"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "a"}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"x", " ", "b"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"x", " ", "u"}]}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x", " ", "v"}]}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", " ", "w"}]}], ")"}]}]}], "-", "1"}], ")"}]}], "-", 
    " ", 
    RowBox[{"u", 
     RowBox[{"(", 
      RowBox[{"1", "+", " ", "v"}], ")"}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", " ", "w"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", " ", "a"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", " ", "b"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "a"}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"x", " ", "b"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"x", " ", "u"}]}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x", " ", "v"}]}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", " ", "w"}]}], ")"}]}]}], "-", "1"}], ")"}]}], "-", 
    " ", 
    RowBox[{"v", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "  ", "w"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", " ", "a"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", " ", "b"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"x", " ", "a"}]}], ")"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "b"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x", " ", "v"}]}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", " ", "w"}]}], ")"}]}]}], "-", "1"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", " ", "a"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", " ", "b"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", " ", 
          RowBox[{"x", " ", "a"}]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "b"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", " ", "w"}]}], ")"}]}]}], "-", "1"}], ")"}]}], "-", 
    RowBox[{"a", " ", "b", " ", 
     RowBox[{
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", " ", "a"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", " ", "b"}], ")"}]}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b", "-", 
         RowBox[{"a", " ", "b"}], "+", "u", "+", "v", "+", "w", "+", 
         RowBox[{"u", " ", "v"}], "+", 
         RowBox[{"u", " ", "w"}], "+", 
         RowBox[{"v", " ", "w"}], "+", 
         RowBox[{"u", " ", "v", " ", "w"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "a"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "b"}], ")"}]}], ")"}]}], ")"}], " ", "x"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fB", "[", 
   RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "a", ",", "b", ",", "u", ",", "v", ",", "w"}], "]"}], 
     "+", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"-", "x"}], ",", "a", ",", "b", ",", 
       RowBox[{"-", "u"}], ",", 
       RowBox[{"-", "v"}], ",", 
       RowBox[{"-", "w"}]}], "]"}]}], ")"}], "/", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fF", "[", 
   RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "a", ",", "b", ",", "u", ",", "v", ",", "w"}], "]"}], 
     "-", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"-", "x"}], ",", "a", ",", "b", ",", 
       RowBox[{"-", "u"}], ",", 
       RowBox[{"-", "v"}], ",", 
       RowBox[{"-", "w"}]}], "]"}]}], ")"}], "/", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zgrav", "[", 
   RowBox[{"x_", ",", "a_", ",", "b_", ",", "u_", ",", "v_", ",", "w_"}], 
   "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", "n"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"fB", "[", 
               RowBox[{
                SuperscriptBox["x", "n"], ",", 
                RowBox[{
                 SuperscriptBox["a", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"3", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["b", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"3", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["u", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"2", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["v", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"2", "n"}]]}], ",", 
                RowBox[{
                 SuperscriptBox["w", "n"], " ", 
                 SuperscriptBox["t", 
                  RowBox[{"2", "n"}]]}]}], "]"}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "n"], 
               RowBox[{"fF", "[", 
                RowBox[{
                 SuperscriptBox["x", "n"], ",", 
                 RowBox[{
                  SuperscriptBox["a", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"3", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["b", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"3", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["u", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"2", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["v", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"2", "n"}]]}], ",", 
                 RowBox[{
                  SuperscriptBox["w", "n"], " ", 
                  SuperscriptBox["t", 
                   RowBox[{"2", "n"}]]}]}], "]"}]}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"level", "/", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "level"}], "}"}]}], "]"}], "//", 
      "Normal"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{"t", "\[Rule]", "1"}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zgravreduced", "[", "x_", "]"}], ":=", 
  RowBox[{"Zgrav", "[", 
   RowBox[{"1", ",", 
    SuperscriptBox["x", "3"], ",", 
    SuperscriptBox["x", "3"], ",", 
    SuperscriptBox["x", "2"], ",", 
    SuperscriptBox["x", "2"], ",", 
    SuperscriptBox["x", "2"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Igravreduced", "[", "x_", "]"}], ":=", 
   RowBox[{"Zgrav", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     SuperscriptBox["x", "3"], ",", 
     SuperscriptBox["x", "3"], ",", 
     RowBox[{"-", 
      SuperscriptBox["x", "2"]}], ",", 
     RowBox[{"-", 
      SuperscriptBox["x", "2"]}], ",", 
     RowBox[{"-", 
      SuperscriptBox["x", "2"]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZUgravreduced", "[", "x_", "]"}], ":=", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ZU1reduced", "[", "x", "]"}], 
     RowBox[{"Zgravreduced", "[", "x", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "level"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IUgravreduced", "[", "x_", "]"}], ":=", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"IU1reduced", "[", "x", "]"}], 
     RowBox[{"Igravreduced", "[", "x", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "level"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8298782590037413`*^9, 3.829878259835702*^9}, {
   3.871983129756228*^9, 3.871983130182479*^9}, {3.871983192145789*^9, 
   3.8719834150909*^9}, {3.871983451739513*^9, 3.871983521642715*^9}, {
   3.871983667023644*^9, 3.871983669277817*^9}, 3.871983729654551*^9, 
   3.8719837743108892`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"7cd5a9e2-ac32-4724-b505-3569a8d23234"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ZUgravreduced", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{"IUgravreduced", "[", "x", "]"}]}], "Input",
 CellChangeTimes->{{3.871983326425639*^9, 3.87198332712307*^9}, {
  3.871983534925856*^9, 3.8719835372151937`*^9}, {3.871983664856028*^9, 
  3.8719836724354677`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"8cd2b5d3-e031-4ebc-b4db-cd31c9b4e862"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["x", "3"]}], "+", 
   RowBox[{"15", " ", 
    SuperscriptBox["x", "4"]}], "+", 
   RowBox[{"18", " ", 
    SuperscriptBox["x", "5"]}], "+", 
   RowBox[{"61", " ", 
    SuperscriptBox["x", "6"]}], "+", 
   RowBox[{"102", " ", 
    SuperscriptBox["x", "7"]}], "+", 
   RowBox[{"264", " ", 
    SuperscriptBox["x", "8"]}], "+", 
   RowBox[{"490", " ", 
    SuperscriptBox["x", "9"]}], "+", 
   RowBox[{"1107", " ", 
    SuperscriptBox["x", "10"]}], "+", 
   RowBox[{"2160", " ", 
    SuperscriptBox["x", "11"]}], "+", 
   RowBox[{"4574", " ", 
    SuperscriptBox["x", "12"]}], "+", 
   RowBox[{"9018", " ", 
    SuperscriptBox["x", "13"]}], "+", 
   RowBox[{"18375", " ", 
    SuperscriptBox["x", "14"]}], "+", 
   RowBox[{"36160", " ", 
    SuperscriptBox["x", "15"]}], "+", 
   RowBox[{"71931", " ", 
    SuperscriptBox["x", "16"]}], "+", 
   RowBox[{"140406", " ", 
    SuperscriptBox["x", "17"]}], "+", 
   RowBox[{"274534", " ", 
    SuperscriptBox["x", "18"]}], "+", 
   RowBox[{"530754", " ", 
    SuperscriptBox["x", "19"]}], "+", 
   RowBox[{"1023942", " ", 
    SuperscriptBox["x", "20"]}], "+", 
   RowBox[{"1960192", " ", 
    SuperscriptBox["x", "21"]}], "+", 
   RowBox[{"3739383", " ", 
    SuperscriptBox["x", "22"]}], "+", 
   RowBox[{"7091604", " ", 
    SuperscriptBox["x", "23"]}], "+", 
   RowBox[{"13396454", " ", 
    SuperscriptBox["x", "24"]}], "+", 
   RowBox[{"25183602", " ", 
    SuperscriptBox["x", "25"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "26"],
    SeriesData[$CellContext`x, 0, {}, 0, 26, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {1, 0, 3, 2, 15, 18, 61, 102, 264, 490, 1107, 
   2160, 4574, 9018, 18375, 36160, 71931, 140406, 274534, 530754, 1023942, 
   1960192, 3739383, 7091604, 13396454, 25183602}, 0, 26, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8719833290590973`*^9, 3.871983336911024*^9}, 
   3.871983426895114*^9, {3.871983502509987*^9, 3.871983537662339*^9}, {
   3.8719836020221024`*^9, 3.8719836184110193`*^9}, 3.871983672798798*^9, {
   3.871983749498658*^9, 3.871983777214857*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"9ab6ab9f-fe8f-418a-ba5a-f94ec68ab20d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["x", "2"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["x", "3"]}], "+", 
   RowBox[{"9", " ", 
    SuperscriptBox["x", "4"]}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "5"]}], "+", 
   RowBox[{"21", " ", 
    SuperscriptBox["x", "6"]}], "-", 
   RowBox[{"18", " ", 
    SuperscriptBox["x", "7"]}], "+", 
   RowBox[{"48", " ", 
    SuperscriptBox["x", "8"]}], "-", 
   RowBox[{"42", " ", 
    SuperscriptBox["x", "9"]}], "+", 
   RowBox[{"99", " ", 
    SuperscriptBox["x", "10"]}], "-", 
   RowBox[{"96", " ", 
    SuperscriptBox["x", "11"]}], "+", 
   RowBox[{"200", " ", 
    SuperscriptBox["x", "12"]}], "-", 
   RowBox[{"198", " ", 
    SuperscriptBox["x", "13"]}], "+", 
   RowBox[{"381", " ", 
    SuperscriptBox["x", "14"]}], "-", 
   RowBox[{"396", " ", 
    SuperscriptBox["x", "15"]}], "+", 
   RowBox[{"711", " ", 
    SuperscriptBox["x", "16"]}], "-", 
   RowBox[{"750", " ", 
    SuperscriptBox["x", "17"]}], "+", 
   RowBox[{"1278", " ", 
    SuperscriptBox["x", "18"]}], "-", 
   RowBox[{"1386", " ", 
    SuperscriptBox["x", "19"]}], "+", 
   RowBox[{"2256", " ", 
    SuperscriptBox["x", "20"]}], "-", 
   RowBox[{"2472", " ", 
    SuperscriptBox["x", "21"]}], "+", 
   RowBox[{"3879", " ", 
    SuperscriptBox["x", "22"]}], "-", 
   RowBox[{"4320", " ", 
    SuperscriptBox["x", "23"]}], "+", 
   RowBox[{"6564", " ", 
    SuperscriptBox["x", "24"]}], "-", 
   RowBox[{"7362", " ", 
    SuperscriptBox["x", "25"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "26"],
    SeriesData[$CellContext`x, 0, {}, 0, 26, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {1, 0, 3, -2, 9, -6, 21, -18, 48, -42, 
   99, -96, 200, -198, 381, -396, 711, -750, 1278, -1386, 2256, -2472, 
   3879, -4320, 6564, -7362}, 0, 26, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8719833290590973`*^9, 3.871983336911024*^9}, 
   3.871983426895114*^9, {3.871983502509987*^9, 3.871983537662339*^9}, {
   3.8719836020221024`*^9, 3.8719836184110193`*^9}, 3.871983672798798*^9, {
   3.871983749498658*^9, 3.871983777225688*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"2f43f203-d95c-40b7-be3b-fb0acac84ccd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tables", "Section",
 CellChangeTimes->{{3.871846316212592*^9, 3.87184633212936*^9}, 
   3.871889664786765*^9, {3.8719393302582827`*^9, 
   3.871939330965405*^9}},ExpressionUUID->"934dcee4-a619-45ee-81d6-\
10831a060355"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NN", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Level\>\"", ",", "\"\<SU\>\"", ",", "\"\<SU Index\>\"", ",", 
           "\"\<U\>\"", ",", " ", "\"\<U Index\>\""}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"MaxLevel", "[", "NN", "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NumAllStates", "[", "NN", "]"}], ",", 
               RowBox[{"Index", "[", "NN", "]"}], ",", 
               RowBox[{"UNumAllStates", "[", "NN", "]"}], ",", 
               RowBox[{"UIndex", "[", "NN", "]"}]}], "}"}], ",", "x"}], 
            "]"}]}], "]"}], "//", "Transpose"}]}], "]"}], "//", 
      "MatrixForm"}], "//", "TeXForm"}], "//", "ToString"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<\\\\\\\\\>\"", "->", "\"\<\\\\\\\\\\\\hline\>\""}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.871935113017352*^9, 3.8719352453893538`*^9}, {
  3.8719353835063963`*^9, 3.871935437231042*^9}, {3.871935659811738*^9, 
  3.871935669055201*^9}, {3.871935707200075*^9, 3.8719357074333963`*^9}, {
  3.871939336169629*^9, 3.8719393362292767`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"26311c20-afff-4f75-86fb-a989bc18d1b4"],

Cell[BoxData["\<\"\\\\left(\\n\\\\begin{array}{ccccc}\\n \\\\text{Level} & \\\
\\text{SU} & \\\\text{SU Index} & \\\\text{U} & \\\\text{U Index} \
\\\\\\\\\\\\hline\\n 0 & 1 & 1 & 1 & 1 \\\\\\\\\\\\hline\\n 1 & 0 & 0 & 0 & 0 \
\\\\\\\\\\\\hline\\n 2 & 0 & 0 & 3 & 3 \\\\\\\\\\\\hline\\n 3 & 0 & 0 & 2 & \
-2 \\\\\\\\\\\\hline\\n 4 & 6 & 6 & 15 & 9 \\\\\\\\\\\\hline\\n 5 & 6 & -6 & \
18 & -6 \\\\\\\\\\\\hline\\n 6 & 9 & -7 & 51 & 11 \\\\\\\\\\\\hline\\n 7 & 18 \
& 18 & 90 & -6 \\\\\\\\\\\\hline\\n 8 & 30 & 6 & 195 & 9 \\\\\\\\\\\\hline\\n \
9 & 40 & -36 & 362 & 14 \\\\\\\\\\\\hline\\n 10 & 66 & 6 & 699 & -21 \\\\\\\\\
\\\\hline\\n 11 & 120 & 84 & 1308 & 36 \\\\\\\\\\\\hline\\n 12 & 198 & -80 & \
2431 & -17 \\\\\\\\\\\\hline\\n 13 & 324 & -132 & 4434 & -18 \
\\\\\\\\\\\\hline\\n 14 & 537 & 309 & 8046 & 114 \\\\\\\\\\\\hline\\n 15 & \
822 & -18 & 14346 & -194 \\\\\\\\\\\\hline\\n 16 & 1257 & -567 & 25434 & 258 \
\\\\\\\\\\\\hline\\n 17 & 1944 & 516 & 44544 & -168 \\\\\\\\\\\\hline\\n 18 & \
2959 & 613 & 77442 & -112 \\\\\\\\\\\\hline\\n 19 & 4476 & -1392 & 133386 & \
630 \\\\\\\\\\\\hline\\n 20 & 6834 & -180 & 228021 & -1089 \
\\\\\\\\\\\\hline\\n 21 & 10352 & 2884 & 386898 & 1130 \\\\\\\\\\\\hline\\n \
22 & 15540 & -1926 & 651843 & -273 \\\\\\\\\\\\hline\\n 23 & 23406 & -4242 & \
1091004 & -1632 \\\\\\\\\\\\hline\\n 24 & 35076 & 7890 & 1814578 & 4104 \
\\\\\\\\\\\\hline\\n 25 & 52020 & 792 & 2999724 & -5364 \
\\\\\\\\\\\\hline\\n\\\\end{array}\\n\\\\right)\"\>"], "Output",
 CellChangeTimes->{{3.8719351191269073`*^9, 3.871935161264043*^9}, {
   3.871935208970592*^9, 3.871935245648686*^9}, {3.871935401390173*^9, 
   3.871935437550166*^9}, {3.8719356661817923`*^9, 3.871935671735002*^9}, 
   3.87193570912724*^9, 3.871939336683663*^9, 3.871982576142366*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"ab3a799f-d7b1-4467-a5b8-f06dbc9cc9d8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.871846316212592*^9, 3.87184633212936*^9}, 
   3.871889664786765*^9, {3.8719393396279783`*^9, 
   3.87193934018727*^9}},ExpressionUUID->"6edca674-e6d4-4d58-8fbc-\
85e969c0ef94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"texStyle", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}], ",", 
     RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BaseStyle", "\[Rule]", "texStyle"}], ",", " ", 
      RowBox[{"PlotMarkers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"None", ",", "Tiny"}], "}"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogLogPlot", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BaseStyle", "\[Rule]", "texStyle"}], ",", " ", 
      RowBox[{"PlotMarkers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"None", ",", "Tiny"}], "}"}]}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", " ", "=", " ", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1.5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.87193822622408*^9, 3.87193823948133*^9}, {
  3.871938330086627*^9, 3.8719383318360453`*^9}, {3.871938383498659*^9, 
  3.871938384246016*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b09c6850-7b34-4485-a1ed-f3016667cce6"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\</Users/yinhslin/git/bh/SU\>\"", "<>", 
       RowBox[{"ToString", "[", "NN", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
      RowBox[{"ListLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"MaxLevel", "[", "NN", "]"}]}], "]"}], ",", 
             RowBox[{"CoefficientList", "[", 
              RowBox[{
               RowBox[{"NumAllStates", "[", "NN", "]"}], ",", "x"}], "]"}]}], 
            "}"}], "//", "Transpose"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"MaxLevel", "[", "NN", "]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"CoefficientList", "[", 
               RowBox[{
                RowBox[{"Index", "[", "NN", "]"}], ",", "x"}], "]"}], "]"}]}],
             "}"}], "//", "Transpose"}]}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"\"\<n\>\"", ",", 
            RowBox[{"Magnification", "\[Rule]", "mag"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"MaTeX", "[", 
          RowBox[{
           RowBox[{"\"\<SU(\>\"", "<>", 
            RowBox[{"ToString", "[", "NN", "]"}], "<>", "\"\<)\>\""}], ",", 
           RowBox[{"Magnification", "\[Rule]", "mag"}]}], "]"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\[FilledCircle]\>\"", ",", "size"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[EmptyCircle]\>\"", ",", "size"}], "}"}]}], "}"}]}],
         ",", 
        RowBox[{"TicksStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "size"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\</Users/yinhslin/git/bh/U\>\"", "<>", 
       RowBox[{"ToString", "[", "NN", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
      RowBox[{"ListLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"MaxLevel", "[", "NN", "]"}]}], "]"}], ",", 
             RowBox[{"CoefficientList", "[", 
              RowBox[{
               RowBox[{"UNumAllStates", "[", "NN", "]"}], ",", "x"}], "]"}]}],
             "}"}], "//", "Transpose"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"MaxLevel", "[", "NN", "]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"CoefficientList", "[", 
               RowBox[{
                RowBox[{"UIndex", "[", "NN", "]"}], ",", "x"}], "]"}], 
              "]"}]}], "}"}], "//", "Transpose"}]}], "}"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"\"\<n\>\"", ",", 
            RowBox[{"Magnification", "\[Rule]", "mag"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"MaTeX", "[", 
          RowBox[{
           RowBox[{"\"\<U(\>\"", "<>", 
            RowBox[{"ToString", "[", "NN", "]"}], "<>", "\"\<)\>\""}], ",", 
           RowBox[{"Magnification", "\[Rule]", "mag"}]}], "]"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\[FilledCircle]\>\"", ",", "size"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[EmptyCircle]\>\"", ",", "size"}], "}"}]}], 
          "}"}]}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"NN", ",", "2", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.871938068461734*^9, 3.8719381341232986`*^9}, {
   3.8719382290518*^9, 3.871938260067389*^9}, {3.871938325106954*^9, 
   3.8719383437880297`*^9}, {3.871938491949864*^9, 3.871938592650091*^9}, {
   3.8719386258502693`*^9, 3.871938636493052*^9}, {3.871938668162964*^9, 
   3.8719387889191713`*^9}, 3.871938884531233*^9, {3.8719824740543413`*^9, 
   3.871982476919424*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"8ccb37b2-dee1-4608-99cd-eaca8833cc52"]
}, Closed]],

Cell[CellGroupData[{

Cell["Load anomalous dimensions", "Section",
 CellChangeTimes->{{3.8718894977127943`*^9, 3.871889499476142*^9}, {
  3.891613201139422*^9, 
  3.89161320500413*^9}},ExpressionUUID->"7679c47b-fc15-4ccb-ae39-\
f42c7e63061e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Load", " ", "data", " ", "first"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ad", "[", "NN", "]"}], "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<ad_\>\"", "<>", 
          
          RowBox[{"ToString", "[", "NN", "]"}], "<>", "\"\<.csv\>\""}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"NN", ",", "2", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MaxLevel", "[", "NN_", "]"}], " ", ":=", " ", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "NN", ",", "\[IndentingNewLine]", "2", ",", "24", ",", 
       "\[IndentingNewLine]", "3", ",", "16", ",", "\[IndentingNewLine]", "4",
        ",", "15"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AD", "[", "NN_", "]"}], ":=", 
     RowBox[{
      RowBox[{"ad", "[", "NN", "]"}], "//", "OrganizeData"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ADUpToLevel", "[", 
      RowBox[{"NN_", ",", "level_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ad", "[", "NN", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<=", "level"}], "&"}]}], "]"}], "//",
       "OrganizeData"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GapUpToLevel", "[", 
      RowBox[{"NN_", ",", "level_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", 
         RowBox[{"ADUpToLevel", "[", 
          RowBox[{"NN", ",", "level"}], "]"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "tmp", "]"}], "==", "1"}], ",", "0", ",", 
         RowBox[{"tmp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AD", "[", 
      RowBox[{"NN_", ",", "charges_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ad", "[", "NN", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", "6"}], "]"}], "]"}], "==", "charges"}], 
         "&"}]}], "]"}], "//", "OrganizeData"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AD", "[", 
      RowBox[{"NN_", ",", "charges_", ",", "degree_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ad", "[", "NN", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", "6"}], "]"}], "]"}], "==", "charges"}], "&&", 
          
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "==", "degree"}]}], "&"}]}], 
       "]"}], "//", "OrganizeData"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrganizeData", "[", "data_", "]"}], ":=", 
     RowBox[{"Tally", "[", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"9", ";;"}], "]"}], "]"}], "&"}], "/@", "data"}], "]"}], 
       "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.871843981562728*^9, 3.871844021412464*^9}, {
   3.871844300547426*^9, 3.871844305441814*^9}, {3.8718466090518503`*^9, 
   3.871846631175758*^9}, {3.871889524731697*^9, 3.871889524937023*^9}, {
   3.871934637857525*^9, 3.871934637997019*^9}, {3.89161320701157*^9, 
   3.891613229075274*^9}, 3.89161386836585*^9, {3.891613957983795*^9, 
   3.8916140352734632`*^9}, {3.8916145630053873`*^9, 3.891614580233369*^9}, {
   3.8916156161022253`*^9, 3.891615623963139*^9}, {3.8916162767578173`*^9, 
   3.891616276778029*^9}, 
   3.891616383683785*^9},ExpressionUUID->"d38fdd89-d247-4c76-8dda-\
c34e8087791e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GapUpToLevel", "[", 
    RowBox[{"NN_", ",", "level_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", "=", 
       RowBox[{"ADUpToLevel", "[", 
        RowBox[{"NN", ",", "level"}], "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "tmp", "]"}], "==", "1"}], ",", "0", ",", 
       RowBox[{"tmp", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.891616351044664*^9, 3.891616377704008*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"7ec286c4-5609-496e-9044-bb9a244d03f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Usage", " ", "example"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ADUpToLevel", "[", 
     RowBox[{"2", ",", "24"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ADUpToLevel", "[", 
     RowBox[{"3", ",", "16"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "5"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ADUpToLevel", "[", 
     RowBox[{"4", ",", "15"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "5"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8916142138291063`*^9, 3.891614315575934*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"d1ba476f-19bf-4d98-b698-aa914444f4a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "17990"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.47546`", ",", "26"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.75`", ",", "1302"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7804`", ",", "610"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.82568`", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.891614214570909*^9, 3.891614282047214*^9}, {
  3.891614312357938*^9, 3.8916143169280043`*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"ab3f7f0f-5c00-4b47-a47e-1fbe80b116a4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "2544"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.83324`", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.85942`", ",", "72"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.03884`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1305`", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.891614214570909*^9, 3.891614282047214*^9}, {
  3.891614312357938*^9, 3.8916143169362993`*^9}},
 CellLabel->
  "Out[147]=",ExpressionUUID->"3875d26c-50df-40d0-879f-2ad1c615ffeb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "2051"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.88412`", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.27864`", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.29666`", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.31934`", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.891614214570909*^9, 3.891614282047214*^9}, {
  3.891614312357938*^9, 3.891614316939238*^9}},
 CellLabel->
  "Out[148]=",ExpressionUUID->"7e7bed25-f54c-44e3-bf1b-6673028a8986"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Sanity", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NumAllStatesUpToLevel", "[", 
    RowBox[{"2", ",", "24"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"NumAllStatesUpToLevel", "[", 
    RowBox[{"3", ",", "16"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"NumAllStatesUpToLevel", "[", 
    RowBox[{"4", ",", "15"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891614381975308*^9, 3.891614385753783*^9}, {
  3.8916144711646957`*^9, 3.891614499905345*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"9912f751-989a-4b45-94cb-843f5f36e4a9"],

Cell[BoxData["17990"], "Output",
 CellChangeTimes->{
  3.891614386107025*^9, {3.891614467276932*^9, 3.891614504131999*^9}},
 CellLabel->
  "Out[184]=",ExpressionUUID->"f4bb818e-ad00-414e-9a55-895dcbfe77c7"],

Cell[BoxData["2544"], "Output",
 CellChangeTimes->{
  3.891614386107025*^9, {3.891614467276932*^9, 3.891614504135372*^9}},
 CellLabel->
  "Out[185]=",ExpressionUUID->"c7c7e59d-6016-46c5-b872-5635c9674bc5"],

Cell[BoxData["2051"], "Output",
 CellChangeTimes->{
  3.891614386107025*^9, {3.891614467276932*^9, 3.8916145041418247`*^9}},
 CellLabel->
  "Out[186]=",ExpressionUUID->"a3acfede-655a-4245-ab3e-58bb967f875d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"GapUpToLevel", "[", 
       RowBox[{"2", ",", "l"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "4", ",", "24"}], "}"}]}], "]"}], "//", 
  "ListPlot"}]], "Input",
 CellChangeTimes->{{3.8916162632191877`*^9, 3.891616271789899*^9}, {
  3.891616392322187*^9, 3.891616398098402*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"e1f92d01-64a4-4c72-803d-3267ba66a83f"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQECDgwoQASNLwHl/7CH0DJofAU0vhIaXwWNr4bG
10Dja6HxdaD8D1C+HhrfAMp/AeUbovGN0PjGaHwTNL4pGt8MjW/uoDBj8fH3
ufegfAs4HwAZQCfE
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 24.}, {0, 1.5}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.891616272957999*^9, 3.891616328214054*^9, {3.891616388952168*^9, 
   3.891616399047702*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"66271709-f175-42af-b6ef-8a700f1378ef"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1145, 747},
WindowMargins->{{Automatic, 115}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"178309e0-88ef-49d0-9a3f-fe47c2ba39ce"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 201, 4, 30, "Input",ExpressionUUID->"e9a463c4-f573-4bdc-bfd1-ac366b2ed6e4"],
Cell[CellGroupData[{
Cell[784, 28, 156, 3, 67, "Section",ExpressionUUID->"72eb439b-d53a-46d1-a943-cdc50184b3e7"],
Cell[943, 33, 3472, 94, 283, "Input",ExpressionUUID->"c60f7b66-59f5-4fe8-afbb-c7f138d1fc76"],
Cell[CellGroupData[{
Cell[4440, 131, 710, 17, 73, "Input",ExpressionUUID->"df88e7a5-f3e0-4241-9426-f502367c19e7"],
Cell[5153, 150, 385, 5, 70, "Output",ExpressionUUID->"d4906fc6-0627-486f-a24c-18ef15c95d64"],
Cell[5541, 157, 387, 5, 70, "Output",ExpressionUUID->"2eafb431-0b7e-41c8-96f4-2f1a7973114f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[5977, 168, 167, 3, 53, "Section",ExpressionUUID->"5df60134-ca17-4e58-bfdb-45e61afd765e"],
Cell[6147, 173, 6106, 165, 321, "Input",ExpressionUUID->"79b5541d-713d-480b-8eb7-cb735d66133c"]
}, Closed]],
Cell[CellGroupData[{
Cell[12290, 343, 185, 3, 53, "Section",ExpressionUUID->"3d356396-679f-4559-9c65-33ecefba003b"],
Cell[12478, 348, 7913, 221, 430, "Input",ExpressionUUID->"87dc0c9b-6b9c-46ef-8667-114efd102d86"],
Cell[CellGroupData[{
Cell[20416, 573, 205, 3, 30, "Input",ExpressionUUID->"2474c19d-5360-473b-8d07-be672424346e"],
Cell[20624, 578, 2035, 61, 56, "Output",ExpressionUUID->"ff05b652-1628-497a-8c2e-b03b79a69146"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22696, 644, 203, 3, 30, "Input",ExpressionUUID->"18cc7b10-b922-4efc-ad97-d64db2405699"],
Cell[22902, 649, 1933, 57, 56, "Output",ExpressionUUID->"14f1115d-1582-448b-9d05-75f5faf26155"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[24884, 712, 174, 3, 53, "Section",ExpressionUUID->"b38d8bef-d1aa-49fc-9525-03332681ba32"],
Cell[25061, 717, 10065, 304, 386, "Input",ExpressionUUID->"7cd5a9e2-ac32-4724-b505-3569a8d23234"],
Cell[CellGroupData[{
Cell[35151, 1025, 381, 6, 52, "Input",ExpressionUUID->"8cd2b5d3-e031-4ebc-b4db-cd31c9b4e862"],
Cell[35535, 1033, 2346, 64, 56, "Output",ExpressionUUID->"9ab6ab9f-fe8f-418a-ba5a-f94ec68ab20d"],
Cell[37884, 1099, 2270, 64, 56, "Output",ExpressionUUID->"2f43f203-d95c-40b7-be3b-fb0acac84ccd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[40203, 1169, 225, 4, 53, "Section",ExpressionUUID->"934dcee4-a619-45ee-81d6-10831a060355"],
Cell[CellGroupData[{
Cell[40453, 1177, 1633, 39, 115, "Input",ExpressionUUID->"26311c20-afff-4f75-86fb-a989bc18d1b4"],
Cell[42089, 1218, 1857, 24, 665, "Output",ExpressionUUID->"ab3a799f-d7b1-4467-a5b8-f06dbc9cc9d8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[43995, 1248, 223, 4, 53, "Section",ExpressionUUID->"6edca674-e6d4-4d58-8fbc-85e969c0ef94"],
Cell[44221, 1254, 1368, 37, 136, "Input",ExpressionUUID->"b09c6850-7b34-4485-a1ed-f3016667cce6"],
Cell[45592, 1293, 4834, 117, 262, "Input",ExpressionUUID->"8ccb37b2-dee1-4608-99cd-eaca8833cc52"]
}, Closed]],
Cell[CellGroupData[{
Cell[50463, 1415, 220, 4, 53, "Section",ExpressionUUID->"7679c47b-fc15-4ccb-ae39-f42c7e63061e"],
Cell[50686, 1421, 4341, 121, 346, "Input",ExpressionUUID->"d38fdd89-d247-4c76-8dda-c34e8087791e"],
Cell[55030, 1544, 712, 20, 30, "Input",ExpressionUUID->"7ec286c4-5609-496e-9044-bb9a244d03f9"],
Cell[CellGroupData[{
Cell[55767, 1568, 800, 22, 94, "Input",ExpressionUUID->"d1ba476f-19bf-4d98-b698-aa914444f4a7"],
Cell[56570, 1592, 582, 16, 34, "Output",ExpressionUUID->"ab3f7f0f-5c00-4b47-a47e-1fbe80b116a4"],
Cell[57155, 1610, 579, 16, 34, "Output",ExpressionUUID->"3875d26c-50df-40d0-879f-2ad1c615ffeb"],
Cell[57737, 1628, 579, 16, 34, "Output",ExpressionUUID->"7e7bed25-f54c-44e3-bf1b-6673028a8986"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58353, 1649, 629, 14, 94, "Input",ExpressionUUID->"9912f751-989a-4b45-94cb-843f5f36e4a9"],
Cell[58985, 1665, 206, 4, 34, "Output",ExpressionUUID->"f4bb818e-ad00-414e-9a55-895dcbfe77c7"],
Cell[59194, 1671, 205, 4, 34, "Output",ExpressionUUID->"c7c7e59d-6016-46c5-b872-5635c9674bc5"],
Cell[59402, 1677, 207, 4, 34, "Output",ExpressionUUID->"a3acfede-655a-4245-ab3e-58bb967f875d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59646, 1686, 496, 13, 30, "Input",ExpressionUUID->"e1f92d01-64a4-4c72-803d-3267ba66a83f"],
Cell[60145, 1701, 1466, 41, 246, "Output",ExpressionUUID->"66271709-f175-42af-b6ef-8a700f1378ef"]
}, Open  ]]
}, Open  ]]
}
]
*)

